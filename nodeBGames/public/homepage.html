<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Rose-Hulman Board Games Club Rental Service</title>
        <link rel="stylesheet" type="text/css" href="stylesheet.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    </head>

    <body>
        <div id="site_background">
            <div id="site_panel">
                <span id="title_section">
                    <img src="rose.png" alt="RHIT Logo" width="128" height="128" id="img_logo"/>
                    Rose-Hulman Board Game Rental Service
                </span>
                <ul id="top_menu">
<<<<<<< HEAD
                    <li><a type="button" class="menu_item" href="javascript:goToHomepage()">
                            Home
                    </a></li>
                    <li><a type="button" class="menu_item" href="javascript:goToGamepage()">
                            Games
                    </a></li>
                    <li><a type="button" class="menu_item" href="javascript:goToClubpage()">
                            Club
                    </a></li>
                    <li><a type="button" class="menu_item" href="javascript:goToHelp()">
                            Help
                    </a></li>
                    <li><a type="button" class="menu_item" href="javascript:goToProfile()">
                            Profile
                    </a></li>
                    <li><a type="button" class="menu_item" href="javascript:goToCheckOut()">
                            Check Out
                    </a></li>
=======
                    <li><a href="" class="menu_item">Home</a></li>
                    <li><a href="" class="menu_item">Games</a></li>
                    <li><a href="" class="menu_item">Club</a></li>
                    <li><a href="" class="menu_item">Help</a></li>
                    <button id="profile_button" type="button" class="menu_item">
                            Profile
                    </button>
>>>>>>> parent of 59c6faf... Added ability to check out games
                </ul>
                <div id="search">
                    <span id="search_elements">
                        <span>
                            <input id="search_box" type="text" placeholder="Search for a game...">
                        </span>
                        <a id="search_button" class="menu_item" href="javascript:searchGames()">
                            Search
                        </a>
                    </span>
                </div>
                <div id="table_header" class="sql_head">
                    <!-- ↗ ↘ -->
                    <table>
                        <tr>
                                <td class="sql_game_name"><button id="name_head" class="table_header_button" onclick="sortBy(0)">Name</button></td>
                                <td class="sql_game_desc"><button id="desc_head" class="table_header_button" onclick="sortBy(1)">Description</button></td>
                                <td class="sql_game_complexity"><button id="complexity_head" class="table_header_button" onclick="sortBy(2)">Complexity</button></td>
                                <td class="sql_game_time"><button id="time_head" class="table_header_button" onclick="sortBy(3)">Playtime</button></td>
                                <td class="sql_game_players"><button id="players_head" class="table_header_button" onclick="sortBy(4)">Max Players</button></td>
                        </tr>
                    </table>
                </div>
                <div id="game_table_div" class="sql_table">
                    <table id="game_table"/>
                </div>
            </div>
        </div>
    </body>
    
    <script>
<<<<<<< HEAD
        window.onload = loadWindow(); //execute blank search on load
=======
        let button = document.getElementById("profile_button");
        button.setAttribute("onclick", "goToProfile()");
        button = document.getElementById("search_button");
		let searchBox = document.getElementById("search_box");
        button.setAttribute("onclick", "searchGames()");
        window.onload = getGameTable();
        //$(document).ready(function() {
        //    $(':button').click(function() {
        //        $('div.response').html('get good'); // show the list
        //        $.get('/request', function(recordset) {
        //            $('div.response').html('bad meme'); // show the list
        //            console.log(recordset);
        //            $('div.response').html(recordset); // show the list
        //        });
        //         
        //    });
        //});
>>>>>>> parent of 59c6faf... Added ability to check out games

        function loadWindow() {
            getGameTable();
        }

		//make search box click button on enter
		searchBox.addEventListener("keyup", function(event) {
				event.preventDefault();
				 if (event.keyCode === 13) {
					button.click();
				}
		});

		function searchGames() {
			var input = searchBox.value;
			console.log("search");
			console.log(input);
			$.get('/search',{searchTerm: input},function(recordset){
				makeTable(recordset);
			});
		}

        function goToProfile() {
<<<<<<< HEAD
            window.location.replace('/profile');
=======
            // $.get('/userCheck',{user: rfUser},function(result){
            //     console.log(result);
            // });
            // console.log("going to profile");
            window.setTimeout(waitProfile,100);
>>>>>>> parent of 59c6faf... Added ability to check out games
        }

        function waitProfile() {
            window.location.replace('/profile');
        }
        
        function getGameTable() {
            $.get('/request', function(recordset) {
                makeTable(recordset);
            });
        }

		function makeTable(recordset) {
			var table = document.getElementById("game_table");
                while (table.firstChild) {
                    table.removeChild(table.firstChild);
                }
                var result;
                for(var index in recordset) {
                    result = recordset[index];

                    var row = document.createElement("tr");

                    var cell = document.createElement("td");
                    cell.setAttribute("class", "sql_game_name");
                    var text = document.createTextNode(result.name);
                    cell.appendChild(text);
                    row.appendChild(cell);

                    var cell = document.createElement("td");
                    cell.setAttribute("class", "sql_game_desc");
                    var text = document.createTextNode(result.description);
                    cell.appendChild(text);
                    row.appendChild(cell);

                    var cell = document.createElement("td");
                    cell.setAttribute("class", "sql_game_complexity");
                    var text = document.createTextNode(result.complexity);
                    cell.appendChild(text);
                    row.appendChild(cell);

                    var cell = document.createElement("td");
                    cell.setAttribute("class", "sql_game_time");
                    var text = document.createTextNode(result.playTime);
                    cell.appendChild(text);
                    row.appendChild(cell);

                    var cell = document.createElement("td");
                    cell.setAttribute("class", "sql_game_players");
                    var text = document.createTextNode(result.numPlayers);
                    cell.appendChild(text);
                    row.appendChild(cell);

                    table.appendChild(row);
                }
		}
    </script>
</html>
